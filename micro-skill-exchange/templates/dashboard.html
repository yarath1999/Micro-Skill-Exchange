<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard_styles.css') }}" />
  <style>
    /* You can move this to dashboard_styles.css later */
    .filter-section { margin-top: 20px; }
    .btn { margin: 5px; }
    .btn-group { margin-top: 10px; }
  </style>
</head>

<body>
  <div id="dashboard" class="dashboard">
    <div class="dashboard-header">
      <div class="dashboard-title">Opportunities</div>
      
      <!-- Add Opportunity button (only for Providers) -->
      <button id="addOpportunityBtn" class="btn btn-add">Add Opportunity</button>
    </div>

    <!-- Filter Section (only for Seekers) -->
    <div class="filter-section">
      <div class="dropdown">
        <button class="dropdown-btn" onclick="toggleDropdown()">Select Skills</button>
        <div id="dropdownContent" class="dropdown-content">
          <label><input type="checkbox" value="web development" onchange="filterBySkills()"> Web Development</label>
          <label><input type="checkbox" value="graphic design" onchange="filterBySkills()"> Graphic Design</label>
          <label><input type="checkbox" value="content writing" onchange="filterBySkills()"> Content Writing</label>
          <label><input type="checkbox" value="digital marketing" onchange="filterBySkills()"> Digital Marketing</label>
          <label><input type="checkbox" value="data entry" onchange="filterBySkills()"> Data Entry</label>
        </div>
      </div>
    </div>

    <!-- Opportunities List (visible to both) -->
    <div id="opportunitiesList">
      <!-- Example Opportunity Card -->
      <div class="opportunity-card" data-skills="web development">
        <div class="opportunity-title">Web Developer Needed</div>
        <div class="opportunity-description">Build a responsive landing page using HTML, CSS, and JavaScript.</div>
        <div class="btn-group">
          <!-- Buttons for Seekers -->
          <button class="btn btn-apply">Apply</button>
          <button class="btn btn-view">View Details</button>

          <!-- Buttons for Providers -->
          <button class="btn btn-edit">Edit</button>
          <button class="btn btn-remove">Remove</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const type = urlParams.get('type'); // 'seeker' or 'provider'
    const dashboard = document.getElementById('dashboard');

    // Role-based Display Logic
    if (type === 'seeker') {
      dashboard.classList.add('seeker-theme');

      // Hide Add Opportunity button
      document.getElementById('addOpportunityBtn').style.display = 'none';

      // Hide Edit and Remove buttons (Provider-only)
      document.querySelectorAll('.btn-edit, .btn-remove').forEach(btn => btn.style.display = 'none');

      // Show Apply and View buttons
      document.querySelectorAll('.btn-apply, .btn-view').forEach(btn => btn.style.display = 'inline-block');

      // Show Filter section
      document.querySelector('.filter-section').style.display = 'block';
    } 
    else if (type === 'provider') {
      // Show Add Opportunity button
      document.getElementById('addOpportunityBtn').style.display = 'inline-block';

      // Show Edit and Remove buttons
      document.querySelectorAll('.btn-edit, .btn-remove').forEach(btn => btn.style.display = 'inline-block');

      // Hide Apply and View buttons
      document.querySelectorAll('.btn-apply, .btn-view').forEach(btn => btn.style.display = 'none');

      // Hide Filter section
      document.querySelector('.filter-section').style.display = 'none';
    }

    // Toggle the visibility of the skill filter dropdown
    function toggleDropdown() {
      const dropdown = document.getElementById('dropdownContent');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    // Filter opportunities based on selected skills
    function filterBySkills() {
      const checkboxes = document.querySelectorAll('#dropdownContent input[type="checkbox"]');
      const selectedSkills = Array.from(checkboxes)
        .filter(checkbox => checkbox.checked)
        .map(checkbox => checkbox.value);

      const cards = document.querySelectorAll('.opportunity-card');
      cards.forEach(card => {
        const skills = card.getAttribute('data-skills') || '';
        const show = selectedSkills.length === 0 || selectedSkills.some(skill => skills.includes(skill));
        card.style.display = show ? 'block' : 'none';
      });
    }

    // Close dropdown when clicking outside
    window.onclick = function(event) {
      if (!event.target.matches('.dropdown-btn')) {
        const dropdowns = document.getElementsByClassName("dropdown-content");
        for (let i = 0; i < dropdowns.length; i++) {
          let openDropdown = dropdowns[i];
          if (openDropdown.style.display === 'block') {
            openDropdown.style.display = 'none';
          }
        }
      }
    }
  </script>

</body>
</html>
